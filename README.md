# Kindai-Voice

# 製品要求仕様書 (PRD): Kindai Voice (仮)

**作成日:** 2025/12/03
**プロジェクト:** 近畿大学情報学部 講義用匿名オピニオンボード
**ステータス:** 開発着手

## 1. プロダクト概要
* **プロダクトの定義:**
    近畿大学情報学部の講義専用の、リアルタイム匿名意見交換プラットフォーム。
* **コンセプト:**
    「空気」を読まずに発言できる場所。講義中の「その場の本音」を可視化し、講義後は「知見」のみを残して「誰が言ったか」は完全に消滅させる。
* **主要機能:**
    登録不要の匿名投稿、リアルタイムのいいね評価、講義終了後のAI要約・生データ自動削除。

## 2. 背景と解決する課題
* **課題 (Problem):**
    * 1講義平均200名の大規模講義において、学生は周囲の目を気にして挙手や発言を躊躇する。
    * 既存のツール（LMS等）は記名式や認証が必要で、心理的障壁が高い。
    * 優れた質問や意見が埋もれ、全体の学習の質が低下している。
* **目的 (Objective):**
    * 心理的安全性を担保し、生徒間での活発な意見交換を誘発する。
* **KGI (ゴール):**
    * 対象講義において、全生徒の8割がサービスを利用し、意見交換を行っている状態。

## 3. ターゲットユーザー
* **ユーザー属性:** 近畿大学 情報学部の学生
* **利用環境:** スマートフォン（メイン）、PC / タブレット
* **規模感:**
    * 1講義あたりの参加者: 約200名
    * 最大同時接続数: 約2,000名（全講義合計のピーク時想定）

## 4. 機能要件 (Functional Requirements)

### 4.1 ユーザーインターフェース (UI)
**画面構成:** シングルページアプリケーション (SPA)

1.  **入室フロー**
    * **認証なし:** ログイン画面は存在しない。
    * **アクセス:** URL（QRコード）または講義コード入力のみで即座に投稿画面へ遷移。
2.  **タイムライン表示**
    * **カード表示:** 投稿内容、投稿時間、いいね数をカード形式で表示。
    * **匿名性:** ユーザー名、アイコン、IDなどは一切表示しない。
3.  **ソート機能（タブ切り替え）**
    * **人気順 (Popular):** 「いいね」の獲得数が多い順に並び替え。
    * **新着順 (Newest):** 投稿日時が新しい順に並び替え。
4.  **投稿フォーム**
    * テキスト入力エリア（文字数制限: 140字〜200字程度を想定）。
    * 送信ボタン（押下後、フォームはクリアされタイムラインに即反映）。
5.  **リアクション**
    * **いいねボタン:** 投稿に対して1人1回まで押下可能。リアルタイムにカウントアップ。

### 4.2 バックエンドロジック
1.  **検索・フィルタリング:** 実装しない。
2.  **管理者機能:** 実装しない（学生・教員ともにフラットな権限）。
3.  **通知:** プッシュ通知、メール通知は実装しない。

## 5. データライフサイクルとAI機能 (Core Specification)

本プロダクトの核心となるプライバシー保護機能の仕様。

1.  **Phase 1: リアルタイム期間（講義中）**
    * 投稿データはデータベースに保存され、全ユーザーにリアルタイム同期される。
    * この時点では「生データ（投稿内容）」が存在する。
2.  **Phase 2: 講義終了トリガー**
    * 設定された時間（例: 講義終了時刻）または手動トリガーにより「講義終了」とみなす。
3.  **Phase 3: AI要約とデータ破棄**
    * システムは当該講義の**全投稿データ**をLLM（AI）に送信する。
    * **生成:** 「主要な論点」「学生の関心事項」を要約したテキストを生成。
    * **保存:** 生成された**要約テキストのみ**を別テーブルに永続保存。
    * **削除:** 元の**投稿データ（生データ）は物理削除**する。復元不可能にする。

## 6. 技術スタック・アーキテクチャ (Technical Stack)

ビジネス化を目的とせず、開発効率とリアルタイム性能を重視した構成。

| レイヤー | 技術選定 | 役割 |
| :--- | :--- | :--- |
| **Frontend** | **Next.js (App Router)** | UI構築。Vercelとの親和性を重視。 |
| **Backend / DB** | **Supabase** | PostgreSQLデータベースおよびRealtime機能（WebSocket）。 |
| **AI** | **OpenAI API** | モデル: `gpt-4o-mini`（コストと精度のバランス重視）。 |
| **Hosting** | **Vercel** | フロントエンドのホスティングおよびServerless Functions。 |
| **Job Scheduler** | **Vercel Cron** | 講義終了後の「要約＆削除処理」を定期実行。 |

## 7. 非機能要件・制約
* **パフォーマンス:** 200名が一斉にアクセス・投稿しても遅延を感じさせないレスポンス（Supabase Realtimeの活用）。
* **セキュリティ:**
    * 認証はないが、SQLインジェクションおよびXSS（クロスサイトスクリプティング）対策はフレームワークレベルで徹底する。
    * 荒らし対策（連投制限など）は、必要に応じてAPIルートのレートリミットで対応。
* **コスト:** Vercel Hobbyプラン（無料）およびSupabase Free Tierの範囲内での運用を目指す。

---

### ネクストステップ

PRDが完成しました。これから開発フェーズに入ります。
まずは**「データベースのテーブル定義」**を作成し、Supabase上に箱を用意するところから始めるのがスムーズです。

テーブル設計（SQL）の案を作成しましょうか？
